<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\File;
use App\Http\Requests;
use App\Http\Helper;
use Mail;

class GeneralController extends Controller {
    /*
     * Request Parameter : [Apikey]
     * Method : POST
     * Request Api Url : "/api/countryList"
     * Request Controller & Method : GeneralController/countryList
     * Success response : [ message : Success.,  code : 200, data: Array of country]
     * Error response : 
      1)[ message : Unauthorised Call. , code : 101]
     */

    public function countryList(Request $request) {
        $Apikey = $request->Apikey;
        if ($Apikey == APIKEY) {
            $countryList = DB::table('country')->where('status', 'Active')->get();
            if (count($countryList) > 0) {
                foreach ($countryList as $country) {
                    $countryList->id = !empty($country->id) ? (int) $country->id : '';
                }
                return response()->json(['message' => 'Success', 'code' => 200, 'data' => $countryList]);
            } else {
                return response()->json(['message' => 'Country doesnot avilable', 'code' => 101]);
            }
        } else {
            return response()->json(['message' => 'Unauthorised Call', 'code' => 101]);
        }
    }

    /*
     * Request Parameter : [Apikey]
     * Method : POST
     * Request Api Url : "/api/stateList"
     * Request Controller & Method : GeneralController/stateList
     * Success response : [ message : Success.,  code : 200, data: Array of State]
     * Error response : 
      1)[ message : Unauthorised Call, code : 101]
      2)[ message : State doesnot avilable, code : 101]
     */

    public function stateList(Request $request) {
        $Apikey = $request->Apikey;
        if ($Apikey == APIKEY) {
            $stateList = DB::table('state')->where('status', 'Active')->get();
            if (count($stateList) > 0) {
                foreach ($stateList as $state) {
                    $stateList->id = !empty($state->id) ? (int) $state->id : '';
                }
                return response()->json(['message' => 'Success', 'code' => 200, 'data' => $stateList]);
            } else {
                return response()->json(['message' => 'State doesnot avilable', 'code' => 101]);
            }
        } else {
            return response()->json(['message' => 'Unauthorised Call', 'code' => 101]);
        }
    }

}
